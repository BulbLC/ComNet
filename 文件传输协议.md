[TOC]

#文件传输协议

##背景

网络环境中的一项基本应用就是文件传送, 即 将文件从一台计算机中复制到另一台可能相距 很远的计算机中。
初看起来, 在两个主机之间传送文件是很简单 的事情，其实网上文件传送并不简单！
原因是: 众多的计算机厂商研制出的文件系统 多达数百种, 且差别很大。



## 文件传输中遇到的问题

网络环境下复制传输文件的复杂性 :
(1) 计算机存储数据的格式不同。
(2) 文件的目录结构和文件命名的规定不同。
(3) 对于相同的文件存取功能, 操作系统使用的 命令不同。
(4) 访问控制方法不同。

## 2.1FTP概述

文件传送协议 FTP (File Transfer Protocol) 是 互联网上使用得最广泛的文件传送协议。FTP 提供交互式的访问, 允许客户指明文件的 类型与格式, 并允许文件具有存取权限。FTP 屏蔽了各计算机系统的细节, 因而适合于 在异构网络中任意计算机之间传送文件。
RFC 959 很早就成为了互联网的正式标准。

### FTP特点

FTP协议只提供文件传送的一些基本的服务, 它 使用 TCP 可靠的运输服务。FTP 的主要功能是减少或消除在不同操作系统 下处理文件的不兼容性。FTP 使用客户/服务器 $(C / S)$ 方式。一个 FTP 服 务器进程可同时为多个客户进程提供服务。FTP 的服务器进程由两大部分组成: 一个主进程, 负责接受新的请求; 另外有若干个从属进程, 负责处理单个请求。

### FTP使用的两个TCP连接

控制连接在整个会话期间一直保持打开, FTP 客户发 出的传送请求通过控制连接发送给服务器端的控制进 程, 但控制连接不用来传送文件。
实际用于传输文件的是 “数据连接”。服务器端的控 制进程在接收到 FTP 客户发送来的文件传输请求后就 创建 “数据传送进程” 和 “数据连接”, 用来连接客 户端和服务器端的数据传送进程。
数据传送进程实际完成文件的传送, 在传送完毕后关 闭 “数据传送连接” 并结束运行。



### FTP主要命令

RFC959定义的FTP控制命令 (客户请求) 主要有:
1. USER: 用于向服务器端发送用户名;
2. PASS: 用于向服务器端发送用户口令;
3. LIST: 用于向服务器端请求发送当前目录的文件列表;
4. PORT：把客户端使用的数据连接临时端口号告诉服务 器 (用于主动模式);
5. PASV: 设置数据连接建立方式为被动模式;
6. RETR: 用于从服务器端当前目录检索文件;
7. STOR: 用于将客户主机的一个文件存储到FTP服务器。

### FTP服务器响应

RFC959定义的FTP服务器的响应主要有:
- 125: 数据连接正确, 准备传输文件;
- 150: 数据连接即将打开;
- 220: 服务就绪;
- 221：服务关闭;
-226: 关闭数据连接;
- 230: 用户注册完成;
-  331: 用户名正确, 需要传输用户口令。

### FTP文件传输应用

■ 常用的FTP客户程序有3种类型:
1. 传统的FTP命令行
2. Web浏览器
-URL地址举例: ftp://ftp.csu.edu.cn
3. 专用的FTP下载工具软件
- 访问FTP服务器:
1. 使用用户口令登录
2. 匿名登录:

>用户名:guest, 口令: anonymous

## 简单文件传输协议TFLP

TFTP (Trivial File Transfer Protocol) 是一个 很小且易于实现的文件传送协议。

TFTP 使用客户/服务器方式和使用 UDP协议传 输文件数据, 因此 TFTP 需要有自己的差错改 正措施。
TFTP 只支持文件传输而不支持交互。
TFTP 没有一个庞大的命令集, 没有列目录的功 能, 也不能对用户进行身份鉴别。